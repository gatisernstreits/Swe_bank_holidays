CREATE PROCEDURE SP_FXO_BSA_DAILY1
@MxDataSetKey numeric(10,0) 
--DROP PROCEDURE SP_BSA_DAILY1

--Just to create table
AS

BEGIN

--IF object_id('FXOPT_BSA_DAILY_REP') IS NOT NULL

--DROP TABLE FXOPT_BSA_DAILY_REP 

IF EXISTS (
  SELECT 1
  FROM sysobjects
  WHERE name = 'FXOPT_BSA_DAILY_REP'
  AND type = 'U'
)
DROP TABLE FXOPT_BSA_DAILY_REP 


IF NOT EXISTS (
  SELECT 1
  FROM sysobjects
  WHERE name = 'FXOPT_BSA_DAILY_REP'
  AND type = 'U'
)
EXECUTE("

CREATE TABLE FXOPT_BSA_DAILY_REP 

(
RCRD_TP_NUM NUMERIC(1,0),
AR_ID VARCHAR(18),
BKGRESU_ID NUMERIC(5,0),
AR_ID_ADDL_PART VARCHAR(15),
LEG_ID NUMERIC(1,0),
BAL_DT VARCHAR(10),
DB_CR_IND varchar(1),
GL_ACCT_CLSS VARCHAR(3),
GL_ACCT_SPEC VARCHAR(5) NULL,
GL_ACCT_TP VARCHAR(4),
FILLER VARCHAR(1),
GL_ACCT_CODE_LCL VARCHAR(1),
BAL_AMT_ORIG NUMERIC(38,3),
CURR_CODE_ORIG VARCHAR(3), 
DB_CR_IND_SUB_BASE VARCHAR(1),
BAL_AMT_SUB_BASE VARCHAR(5),
CURR_CODE_SUB_BASE VARCHAR(1),
STRT_DT VARCHAR(10),
EXP_DT VARCHAR(10),
BSA_AMT_TP VARCHAR(1),
STOREDP_REF  varchar(25)
)
")
END
return 0